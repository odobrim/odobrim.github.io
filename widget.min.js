var _odobrimWidget=function(t,o){"use strict";function n(n){var e=new URLSearchParams;for(var r in n)n.hasOwnProperty(r)&&e.append(r,n[r]);return e.append("location",function(){var n;try{n=t.top.location.href}catch(r){if(""!==o.domain){var e=t.location.protocol;n=("data:"===e?"http://":e)+o.domain}else n=t.location.href}return n}()),e.append("token",i),"//"+n.server+"/widget/"+n.widgetId+"/?"+e}function e(t){var o=t.data;try{o=JSON.parse(o)}catch(t){o=null}null!==o&&"object"==typeof o&&o.token===i&&(r.hasOwnProperty(o.action)?r[o.action](o.data):console.log('неверный "action" '+o.action))}if(t===t.top){var r={changeWidgetHeight:function(t){d.height=t.value},scrollToWidget:function(n){var e=Math.max(o.body.scrollTop,o.documentElement.scrollTop),r=d.getBoundingClientRect().top+e;t.scrollTo(0,r+(n.offset||0))},scrollToWidgetCenter:function(){r.scrollToWidget({offset:d.clientHeight/2-t.innerHeight/2})}},a=[],i=btoa(Math.random().toString()),c={init:function(r,i,u){if(!l){if("string"==typeof r)try{r=JSON.parse(r)}catch(t){r=null}if(null===r||"object"!=typeof r)throw new Error('Invalid parameter "data". Object type expected');!function(t,o){t.forEach(function(t){if(null===o[t]||void 0===o[t])throw new Error('"'+t+'" is required')})}(["partnerId","server","type","widgetId"],r),function(t,o){t.forEach(function(t){if(o[t]&&!o[t].match(/^[0-9A-Fa-f]{6}$/))throw new Error('"'+t+'" need to be HEX format')})}(["textColor","bgColor","buttonColor","h1Color","h2Color"],r);var s=o.createElement("iframe");s.frameBorder=0,s.scrolling="no",s.onload=function(){f=!0,a.forEach(function(t){t()})}.bind(null,s),s.width="100%",s.height=0,s.src=n(r),l=!0,d=s,function(t,n){n.parentNode===o.head?"loading"!==o.readyState?o.body.appendChild(t):o.addEventListener("DOMContentLoaded",function(){o.body.appendChild(t)}):n.parentNode.insertBefore(t,n)}(s,u||c._target),t.addEventListener("message",e),c.ready(i)}},ready:function(t){"function"==typeof t&&(f?setTimeout(t,0):a.push(t))},sendAction:function(t,o){c.ready(function(){var n={action:t,token:i,data:o};d.contentWindow.postMessage(JSON.stringify(n),"*")})}},d=null,l=!1,f=!1;return c}console.log("наш скрипт вставили внутрь другого айфейма")}(window,document);
